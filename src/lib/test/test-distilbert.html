<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DistilBERT MNLI Evaluation Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .loading { background: #e3f2fd; border: 1px solid #2196f3; }
        .success { background: #e8f5e8; border: 1px solid #4caf50; }
        .error { background: #ffebee; border: 1px solid #f44336; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 4px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>DistilBERT MNLI Evaluation Test</h1>
    
    <div id="status" class="status loading">
        Loading evaluation framework...
    </div>
    
    <div id="controls">
        <button id="loadModel" onclick="loadModel()">1. Load DistilBERT Model</button>
        <button id="runBenchmark" onclick="runBenchmark()" disabled>2. Run Performance Benchmark</button>
        <button id="testAccuracy" onclick="testAccuracy()" disabled>3. Test Classification Accuracy</button>
    </div>
    
    <div id="results"></div>
    
    <script type="module">
        import { DistilBERTMNLIEvaluator } from './distilbert-mnli-evaluation.js';
        
        let evaluator;
        
        window.addEventListener('load', async () => {
            try {
                evaluator = new DistilBERTMNLIEvaluator();
                document.getElementById('status').innerHTML = '‚úÖ Evaluation framework ready';
                document.getElementById('status').className = 'status success';
            } catch (error) {
                document.getElementById('status').innerHTML = `‚ùå Error: ${error.message}`;
                document.getElementById('status').className = 'status error';
            }
        });
        
        window.loadModel = async function() {
            const button = document.getElementById('loadModel');
            const status = document.getElementById('status');
            
            button.disabled = true;
            button.textContent = 'Loading...';
            status.innerHTML = 'üîÑ Loading DistilBERT MNLI model...';
            status.className = 'status loading';
            
            try {
                const result = await evaluator.loadModel();
                
                if (result.success) {
                    status.innerHTML = `‚úÖ Model loaded successfully in ${result.loadTime.toFixed(2)}ms`;
                    status.className = 'status success';
                    document.getElementById('runBenchmark').disabled = false;
                    document.getElementById('testAccuracy').disabled = false;
                } else {
                    status.innerHTML = `‚ùå Failed to load model: ${result.error}`;
                    status.className = 'status error';
                }
            } catch (error) {
                status.innerHTML = `‚ùå Error loading model: ${error.message}`;
                status.className = 'status error';
            }
            
            button.disabled = false;
            button.textContent = '1. Load DistilBERT Model';
        };
        
        window.runBenchmark = async function() {
            const button = document.getElementById('runBenchmark');
            const resultsDiv = document.getElementById('results');
            
            button.disabled = true;
            button.textContent = 'Running Benchmark...';
            
            try {
                const results = await evaluator.runPerformanceBenchmark();
                
                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>üìä Performance Benchmark Results</h3>
                        <p><strong>Model Load Time:</strong> ${results.modelLoadResult.loadTime.toFixed(2)}ms</p>
                        <p><strong>Average Inference Time:</strong> ${results.averageInferenceTime.toFixed(2)}ms</p>
                        <p><strong>Model Size:</strong> ${results.modelSize}</p>
                        <p><strong>Memory Usage:</strong> ${results.memoryUsage}</p>
                        
                        <h4>üîç Classification Results:</h4>
                        <pre>${JSON.stringify(results.classifications, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="result error">Error running benchmark: ${error.message}</div>`;
            }
            
            button.disabled = false;
            button.textContent = '2. Run Performance Benchmark';
        };
        
        window.testAccuracy = async function() {
            const button = document.getElementById('testAccuracy');
            const resultsDiv = document.getElementById('results');
            
            button.disabled = true;
            button.textContent = 'Testing Accuracy...';
            
            try {
                const results = await evaluator.testAccuracyWithExpectedResults();
                
                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>üéØ Accuracy Test Results</h3>
                        <p><strong>Overall Accuracy:</strong> ${results.accuracy.toFixed(1)}% (${results.correct}/${results.total})</p>
                        
                        <h4>üìã Detailed Results:</h4>
                        <table border="1" style="width:100%; border-collapse: collapse;">
                            <tr>
                                <th>Input</th>
                                <th>Expected</th>
                                <th>Predicted</th>
                                <th>Confidence</th>
                                <th>Correct</th>
                            </tr>
                            ${results.results.map(r => `
                                <tr style="background: ${r.correct ? '#e8f5e8' : '#ffebee'}">
                                    <td>${r.input}</td>
                                    <td>${r.expected}</td>
                                    <td>${r.predicted}</td>
                                    <td>${(r.confidence * 100).toFixed(1)}%</td>
                                    <td>${r.correct ? '‚úÖ' : '‚ùå'}</td>
                                </tr>
                            `).join('')}
                        </table>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="result error">Error testing accuracy: ${error.message}</div>`;
            }
            
            button.disabled = false;
            button.textContent = '3. Test Classification Accuracy';
        };
    </script>
</body>
</html>